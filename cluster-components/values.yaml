---
# Main common configuration for the chart.

# All applications whose 'enabled' flag is false by default are applications that are
# already installed in the cluster by the main swh provisioning except for the clusters
# minikube (local dev) and rancher (admin cluster).
cert-manager:
  enabled: false

prometheus:
  enabled: false
  namespaceOverride: cattle-monitoring-system
  alertmanager:
    enabled: true
    ircrelay:
      enabled: true
      host: https://alertmanager-irc-relay.admin.swh.network/swh-sysadm
      # .htaccess or authentication credentials
      # secret:
  grafana:
    namespaceOverride: cattle-monitoring-system
  prometheus-node-exporter:
    namespaceOverride: cattle-monitoring-system
  kube-state-metrics:
    namespaceOverride: cattle-monitoring-system

alertmanagerIrcRelay:
  enabled: false
  ingress:
    enabled: true
    host: alertmanager-irc-relay.admin.swh.network
    # secret holding the .htpasswd information
    authentication: ingress-nginx/basic-auth
    tls:
      enabled: true
      # clusterIssuer: letsencrypt-production
  http_port: 8000
  # Room to connect to
  room: swh-sysadm
  # requestedMemory: "128Mi"
  # requestedCpu: "500"
  # optional
  # limitedMemory: "256Mi"
  # limitedCpu: "1000"

blackboxExporter:
  enabled: false
  nameOverride: blackbox-exporter
  namespaceOverride: cattle-monitoring-system
  serviceMonitor:
    enabled: true
    selfMonitor:
      enabled: true
    prometheusRule:
      enabled: true
  pspEnabled: false
  config:
    modules:
      swh_www:
        prober: http
        timeout: 5s
        http:
          valid_http_versions: ["HTTP/1.1", "HTTP/2.0"]
          follow_redirects: true
          preferred_ip_protocol: "ip4"
          fail_if_body_not_matches_regexp:
            - '<title>Software Heritage</title>'
