{{- if and .Values.alertmanagerConfig.enabled }}
---
apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: irc-relay-config
  namespace: cattle-monitoring-system
spec:
  route:
    groupBy: ['...']
    groupWait: 31s
    groupInterval: 120s
    repeatInterval: 12h
    receiver: ircrelay
    continue: true
    routes:
      - receiver: "null"
        continue: false
        matchers:
        - name: "alertname"
          regex: true
          value: "InfoInhibitor"
  receivers:
    - name: "null"
    - name: ircrelay
      webhookConfigs:
        - sendResolved: true
          url: {{ .Values.alertmanager.ircrelay.host }}
          httpConfig:
            basicAuth:
              username:
                key: user
                name: alertmanager-irc-relay-config
              password:
                key: password
                name: alertmanager-irc-relay-config
{{ end }}
