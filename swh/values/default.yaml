namespace: swh

sentry:
  enabled: true

tmpEphemeralStorage:
  claimTemplate:
    ephemeral:
      volumeClaimTemplate:
        metadata:
          labels:
            type: ephemeral-volume
        spec:
          accessModes: [ "ReadWriteOnce" ]
          storageClassName: "local-path"
          resources:
            requests:
              storage: 100Gi # no effects

checker_deposit:
  sentry:
    enabled: true

storage_replayer:
  sentry:
    enabled: true
  maxMessagesBytes: "524288000"
  journalBrokers:
    # The name of the secret containing the BROKER_USER_PASSWORD value
    secretName: storage-replayer-broker-secret
  cassandra:
    keySpace: swh
    consistencyLevel: LOCAL_QUORUM
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: node-role.kubernetes.io/etcd
            operator: NotIn
            values:
            - "true"

cookers:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: "swh/cooker"
            operator: In
            values:
            - "true"

loader_metadata:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: "swh/loader-metadata"
            operator: In
            values:
            - "true"

indexers:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: "swh/indexer"
            operator: In
            values:
            - "true"

loaders:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: "swh/loader"
            operator: In
            values:
            - "true"

listers:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: "swh/lister"
            operator: In
            values:
            - "true"

graphql:
  sentry:
    enabled: true
  ingress:
    extraAnnotations:
      nginx.ingress.kubernetes.io/rewrite-target: /
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/rpc
            operator: In
            values:
            - "true"

storage:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/storage
            operator: In
            values:
            - "true"

scheduler:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/scheduler
            operator: In
            values:
            - "true"

vault:
  sentry:
    enabled: true
  extraConfig:
    smtp:
      host: smtp.inria.fr
      port: 25
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/rpc
            operator: In
            values:
            - "true"

web:
  requestedCpu: 50m
  requestedMemory: 300Mi
  migrations:
    enabled: true
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/web
            operator: In
            values:
            - "true"

deposit:
  migrations:
    enabled: true
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/deposit
            operator: In
            values:
            - "true"

indexerStorage:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/rpc
            operator: In
            values:
            - "true"

search:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/rpc
            operator: In
            values:
            - "true"
  journalClients:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: swh/journal_client
            operator: In
            values:
            - "true"

scrubber:
  sentry:
    enabled: true
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: "swh/scrubber"
            operator: In
            values:
            - "true"

statsd_exporter:
  enabled: true
