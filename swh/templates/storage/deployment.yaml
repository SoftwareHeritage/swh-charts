{{ if .Values.storage.enabled -}}
{{ range $storage_type, $deployment_config := .Values.storage.deployments }}
{{- if or (not (hasKey $deployment_config "enabled")) (get $deployment_config "enabled") -}}
{{- include "swh.storage.deployment"
  (dict "serviceType"       ( print "storage-" $storage_type )
        "configuration"     $deployment_config
        "Values"            $.Values
        "databaseUtilsPath" ( print $.Template.BasePath "/utils/database-utils.yaml" )
        "configUtilsPath"   ( print $.Template.BasePath "/utils/config-utils.yaml" )) -}}
{{- end -}}
{{ end -}}
{{- end -}}
