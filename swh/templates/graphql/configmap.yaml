{{ if .Values.graphql.enabled -}}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: graphql
  namespace: {{ .Values.namespace }}
data:
  config.yml: |
    {{- range $backend, $backend_config := .Values.graphql.backends }}
    {{ $backend }}:
      cls: remote
      url: http://{{ get $backend_config "host" }}:{{ get $backend_config "port" }}
    {{- end }}
    debug: yes

    server-type: wsgi
{{ end }}
