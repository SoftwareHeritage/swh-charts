{{ if .Values.toolbox.enabled -}}
{{- $namespace := .Values.namespace -}}
{{- range $service_type, $deployment_config := .Values.toolbox.configs }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: toolbox-{{ $service_type }}-template
  namespace: {{ $namespace }}
data:
  config.yml.template: |
    {{ if ( eq "scheduler" $service_type ) }}
{{ include "swh.scheduler.postgresql" (list $.Values $deployment_config) | indent 4 }}
    {{ else if ( eq "storage" $service_type ) }}
{{ include "swh.storage.postgresql" (list $.Values $deployment_config list) | indent 4 }}
    {{ else }}
    {{ fail (print "Configuration " $service_type " unsupported.") }}
    {{- end -}}

{{ end }}
{{- end -}}
