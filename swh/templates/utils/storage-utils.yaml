---
apiVersion: v1
kind: ConfigMap
metadata:
  name: storage-utils
  namespace: {{ $.Values.namespace }}
data:
  init-keyspace-py: |
    from swh.core import config
    from swh.storage.cassandra import create_keyspace

    c=config.read('/etc/swh/config.yml')

    storage_config = c["storage"]
    hosts = storage_config.get("hosts")

    # print(f"************ storage_config: {storage_config}" )
    # print(f"************ hosts: {hosts}" )

    create_keyspace(hosts=hosts, keyspace='swh', auth_provider=storage_config.get("auth_provider"))
